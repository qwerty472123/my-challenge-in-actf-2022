## CryptoNote

### Difficulty

Middle-High

### Description

Tired of solidity? Let's take a look at the blockchain challenges without EVM!

In short, on a blockchain system based on ~~solo consensus and~~ ring signature, Alice borrowed 1 tokens from Carol through Bob.

Now, the partnership between Bob and Carol has broken down.

Bob(**verified**): Do you remember the 1 token I lent you? Pay off that loan, now!

Carol: Do you remember the 1 tokens you borrowed from Bob? That's actually belongs to me. Give it back!

Alice: But I only have 1 token. /(ㄒoㄒ)/~~

Please help Alice complete the repayment and Capture The Flag.

By the way, Alice has forgotten Bob's address, and Carol pays great attention to protecting her privacy, so she refuses to disclose her address, but she promised(**verified**) the x-coordinate of her address (a point on an elliptic curve) in the range of $[0,2^{256}]$.

`blockchain_service.py` is running on `127.0.0.1:8080`.

Here are descriptions of provided files:

|file name|description|
|:-:|:-:|
|`signed_message_from_bob.json`|What Bob said and its signature.|
|`signed_message_verifier.py`|Signature verifier for `signed_message_from_bob.json`.|
|`range_proof_from_carol.json`|The range proof for x-coordinate of Carol's address|
|`range_proof_verifier.py`|Range proof verifier for `range_proof_from_carol.json`.|
|`blockchain_service.py`|The blockchain system mentioned before.|
|`ring_signature.py`|A library for ring signature|
|`secret.py`|A sample for the real `secret.py`|

### Key points

- ecrecover for SM2 signature scheme
- The anonymity for one-time ring signature is broken on the type-A pairing-friendly curve.(In fact, the difficulty of ECDDHP on the type-A pairing-friendly curve is broken.）
- When the transaction system use coprime order curve like ed25519 without verifying that the key image of the one-time ring signature is on the subgroup generated by the base point, double-spend will be allowed. (<https://www.getmonero.org/2017/05/17/disclosure-of-a-major-bug-in-cryptonote-based-currencies.html>)

### Descriptions for solution file

|file name|description|
|:-:|:-:|
|`bob_public_key_restore.py`|The script to restore Bob's public key.|
|`carol_public_key_restore.py`|The script to restore Carol's public key.|
|`solution.py`|The real solution.|

### Descriptions for hint 1 file

|file name|description|
|:-:|:-:|
|`bob_signed_generate.py`|The generator for `signed_message_from_bob.json`|
|`carol_range_proof_generate.py`|The generator for `range_proof_from_carol.json`|

### Descriptions for other files in src

|file name|description|
|:-:|:-:|
|`solution_fake.py`|An example for transactions.|
|`solution_poc.py`|An example for double-spend.|
|`secret_demo.py`|The `secret.py` in attachments.|
|`secret.py`|The real secrets.|
|`calc_edo_curve.sage`|The generator for embedding degree one curve.|
|`calc_bn_curve.py`|The generator for BN curve(Abandoned draft).|
|`build_attachment.sh`|The generator for `attachment.tar.gz` and `hint1.tar.gz`|
|`copy_solution.sh`|Copy solution file to solution directory.|
|`copy_deploy.sh`|Copy deployment file to deploy directory.|
|`deploy.sh`|The file for docker.|
|`run_instance.sh`|The file for docker.|
|`run_socat.sh`|The file for docker.|
|`Dockerfile`|The file for docker.|
